# Caches I

*December 8, 2024*

## Binary Prefix

| Name | SI Name | Abbr |  Factor  |
| :--: | :-----: | :--: | :------: |
| kibi |  kilo   |  Ki  | $2^{10}$ |
| mebi |  mega   |  Mi  | $2^{20}$ |
| gibi |  giga   |  Gi  | $2^{30}$ |
| tebi |  tera   |  Ti  | $2^{40}$ |
| pebi |  peta   |  Pi  | $2^{50}$ |
| exbi |   exa   |  Ei  | $2^{60}$ |
| zebi |  zetta  |  Zi  | $2^{70}$ |
| yobi |  yotta  |  Yi  | $2^{80}$ |

- 国际电工委员会（IEC）于 1999 年引入这些前缀，用于指定二进制量
- 名称来自原始 SI 前缀的简称（发音相同）
	- bi 是"binary"的简称，但发音为 "bee"
- 现在 SI 前缀只有基 10 的含义，而没有基 2 的含义

记忆 2 的幂次对应的读法的方法：

- 如 $2^{34}, x=3, y=4$ 
- 3对应gibi，4对应16
- 所以 $2^{34} = 16gibi$ 

## Library Analogy

pass...

## Memory Hierarchy

- 处理器和内存速度的不匹配导致我们增加了一个新的层次
	- 引入"内存缓存"（memory **cache**）
- 使用与 CPU 相同的集成电路处理技术实现（通常集成在同一芯片上）
	- 比 DRAM 内存更快但更昂贵。
- **缓存是主存子集的副本** 
- 大多数处理器都有单独的指令和数据缓存

典型的**内存层次结构**：

![[typical memory hierarchy.png]]

- **关键技巧**：为处理器提供一个内存系统，它能以*最快*技术所能达到的速度提供尽可能多的*最便宜*技术所能容纳的内存空间
- 如果层次更接近处理器，则：
	- 更小
	- 速度更快
	- 更昂贵
	- 是较低级别的子集（包含最近使用的数据）
- 最低层（通常是磁盘=HDD/ SSD）包含所有可用数据

> 高速缓存为处理器提供了一个超大、超快内存的**假象**（*illusion*）。

## Locality, Design, Management

内存层次结构基础：

- 缓存（Cache）包含正在使用的内存数据的副本
- 内存包含正在使用的磁盘数据的副本
- 缓存基于**时间局部性和空间局部性**（*temporal and spatial locality*）原理工作：

1. 时间局部性
- 如果某个内存位置被访问，它很可能在短期内再次被访问
- 解决方案：将最近访问的数据项放置在更靠近处理器的位置

2. 空间局部性
- 如果某个内存位置被访问，具有临近地址的位置很可能很快也会被访问
- 解决方案：将由连续字组成的**数据块**（*block*）移动到更靠近处理器的位置

层次结构如何管理：

- 寄存器与内存之间的管理
	- 由编译器（或汇编语言程序员）完成

- 缓存与主存之间的管理
	- 由缓存控制器硬件完成

- 主存与磁盘（secondary storage，次级存储）之间的管理
	- 由操作系统（virtual memory，虚拟内存）完成
	- 虚拟地址到物理地址的映射由硬件（转换后备缓冲器或TLB）辅助完成
		- TLB也是一种缓存
	- 由程序员（通过文件操作）完成
